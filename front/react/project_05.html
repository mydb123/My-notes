<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>react列表系列 | notes</title>
    <meta name="description" content="notes">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/My-notes/icons/favicon.ico">
  <link rel="manifest" href="/My-notes/manifest.json">
    
    <link rel="preload" href="/My-notes/assets/css/0.styles.5acd7f6f.css" as="style"><link rel="preload" href="/My-notes/assets/js/app.015e7f34.js" as="script"><link rel="preload" href="/My-notes/assets/js/2.a0b16310.js" as="script"><link rel="preload" href="/My-notes/assets/js/34.4fa64215.js" as="script"><link rel="preload" href="/My-notes/assets/js/3.d5588be5.js" as="script"><link rel="prefetch" href="/My-notes/assets/js/10.7aadc58a.js"><link rel="prefetch" href="/My-notes/assets/js/11.b4e1d08a.js"><link rel="prefetch" href="/My-notes/assets/js/12.0622404e.js"><link rel="prefetch" href="/My-notes/assets/js/13.16a73702.js"><link rel="prefetch" href="/My-notes/assets/js/14.7760d2a2.js"><link rel="prefetch" href="/My-notes/assets/js/15.1ecbed82.js"><link rel="prefetch" href="/My-notes/assets/js/16.dde570c1.js"><link rel="prefetch" href="/My-notes/assets/js/17.b4f283e0.js"><link rel="prefetch" href="/My-notes/assets/js/18.eab48c79.js"><link rel="prefetch" href="/My-notes/assets/js/19.9e33ace1.js"><link rel="prefetch" href="/My-notes/assets/js/20.bbd68983.js"><link rel="prefetch" href="/My-notes/assets/js/21.e359b895.js"><link rel="prefetch" href="/My-notes/assets/js/22.5d656200.js"><link rel="prefetch" href="/My-notes/assets/js/23.dbf290ae.js"><link rel="prefetch" href="/My-notes/assets/js/24.1656276c.js"><link rel="prefetch" href="/My-notes/assets/js/25.02672a6d.js"><link rel="prefetch" href="/My-notes/assets/js/26.cfd7ebac.js"><link rel="prefetch" href="/My-notes/assets/js/27.8b9abcef.js"><link rel="prefetch" href="/My-notes/assets/js/28.088bad68.js"><link rel="prefetch" href="/My-notes/assets/js/29.6922eaab.js"><link rel="prefetch" href="/My-notes/assets/js/30.28e8ab7b.js"><link rel="prefetch" href="/My-notes/assets/js/31.437c6a41.js"><link rel="prefetch" href="/My-notes/assets/js/32.2a1c6394.js"><link rel="prefetch" href="/My-notes/assets/js/33.39d85b34.js"><link rel="prefetch" href="/My-notes/assets/js/35.2efb8c75.js"><link rel="prefetch" href="/My-notes/assets/js/36.0262a3d1.js"><link rel="prefetch" href="/My-notes/assets/js/37.2b5135e5.js"><link rel="prefetch" href="/My-notes/assets/js/38.a9f2e0c1.js"><link rel="prefetch" href="/My-notes/assets/js/39.ed5b32a4.js"><link rel="prefetch" href="/My-notes/assets/js/4.7c8e17c5.js"><link rel="prefetch" href="/My-notes/assets/js/40.61be5f0a.js"><link rel="prefetch" href="/My-notes/assets/js/41.1844b6a5.js"><link rel="prefetch" href="/My-notes/assets/js/42.7f3395a1.js"><link rel="prefetch" href="/My-notes/assets/js/43.dfee4b51.js"><link rel="prefetch" href="/My-notes/assets/js/44.3af44580.js"><link rel="prefetch" href="/My-notes/assets/js/45.0a08c68b.js"><link rel="prefetch" href="/My-notes/assets/js/46.9f4bcb48.js"><link rel="prefetch" href="/My-notes/assets/js/47.9d79e965.js"><link rel="prefetch" href="/My-notes/assets/js/48.63f99b10.js"><link rel="prefetch" href="/My-notes/assets/js/49.f072b338.js"><link rel="prefetch" href="/My-notes/assets/js/5.5a688d0c.js"><link rel="prefetch" href="/My-notes/assets/js/50.133611ad.js"><link rel="prefetch" href="/My-notes/assets/js/51.24ee410a.js"><link rel="prefetch" href="/My-notes/assets/js/52.24ae560c.js"><link rel="prefetch" href="/My-notes/assets/js/53.b8b7e229.js"><link rel="prefetch" href="/My-notes/assets/js/54.2dfcce20.js"><link rel="prefetch" href="/My-notes/assets/js/55.e376e3ab.js"><link rel="prefetch" href="/My-notes/assets/js/56.2c0a24f7.js"><link rel="prefetch" href="/My-notes/assets/js/57.c48c839b.js"><link rel="prefetch" href="/My-notes/assets/js/58.83a5e4f8.js"><link rel="prefetch" href="/My-notes/assets/js/59.b10cd758.js"><link rel="prefetch" href="/My-notes/assets/js/6.29d76593.js"><link rel="prefetch" href="/My-notes/assets/js/60.6aa158f7.js"><link rel="prefetch" href="/My-notes/assets/js/61.b16a7d04.js"><link rel="prefetch" href="/My-notes/assets/js/62.9d95c51c.js"><link rel="prefetch" href="/My-notes/assets/js/63.e7e19435.js"><link rel="prefetch" href="/My-notes/assets/js/64.33833ea8.js"><link rel="prefetch" href="/My-notes/assets/js/65.d077cee0.js"><link rel="prefetch" href="/My-notes/assets/js/66.b1aa190f.js"><link rel="prefetch" href="/My-notes/assets/js/67.52d57de9.js"><link rel="prefetch" href="/My-notes/assets/js/68.80215707.js"><link rel="prefetch" href="/My-notes/assets/js/69.301e3599.js"><link rel="prefetch" href="/My-notes/assets/js/7.8a6613f0.js"><link rel="prefetch" href="/My-notes/assets/js/70.bbe26619.js"><link rel="prefetch" href="/My-notes/assets/js/71.cc08ffd7.js"><link rel="prefetch" href="/My-notes/assets/js/72.41ec8713.js"><link rel="prefetch" href="/My-notes/assets/js/73.4c26e4c6.js"><link rel="prefetch" href="/My-notes/assets/js/74.26cc9ec4.js"><link rel="prefetch" href="/My-notes/assets/js/75.04babf90.js"><link rel="prefetch" href="/My-notes/assets/js/76.60006f9d.js"><link rel="prefetch" href="/My-notes/assets/js/77.907d8280.js"><link rel="prefetch" href="/My-notes/assets/js/78.a5a15493.js"><link rel="prefetch" href="/My-notes/assets/js/79.c0d8438f.js"><link rel="prefetch" href="/My-notes/assets/js/8.7674507a.js"><link rel="prefetch" href="/My-notes/assets/js/80.c5f57175.js"><link rel="prefetch" href="/My-notes/assets/js/81.57a9cf0b.js"><link rel="prefetch" href="/My-notes/assets/js/82.ddb36f01.js"><link rel="prefetch" href="/My-notes/assets/js/83.adfdbd9d.js"><link rel="prefetch" href="/My-notes/assets/js/84.a30985d6.js"><link rel="prefetch" href="/My-notes/assets/js/85.a53fddd6.js"><link rel="prefetch" href="/My-notes/assets/js/86.3cefc076.js"><link rel="prefetch" href="/My-notes/assets/js/87.69ad01b3.js"><link rel="prefetch" href="/My-notes/assets/js/9.c2d910f0.js">
    <link rel="stylesheet" href="/My-notes/assets/css/0.styles.5acd7f6f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/My-notes/" class="home-link router-link-active"><!----> <span class="site-name">notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/My-notes/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/My-notes/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/front/htmlcss/" class="nav-link">
  HtmlCss
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/javascript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/webapi/" class="nav-link">
  WebAPI
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/jquery/" class="nav-link">
  jQuery
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/react/" class="nav-link router-link-active">
  React
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/threejs/" class="nav-link">
  ThreeJs
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/backend/java/" class="nav-link">
  Java
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="移动端" class="dropdown-title"><span class="title">移动端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/mobile/applets/" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/mobile/application/" class="nav-link">
  uni-app
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/tools/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/tools/vscode/" class="nav-link">
  VSCode
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><span class="title">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/others/utils/" class="nav-link">
  Utils
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/others/recording/" class="nav-link">
  随心记
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/others/interview/" class="nav-link">
  面试宝典
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/others/javadeploy/" class="nav-link">
  java配置
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/others/standard/" class="nav-link">
  规范
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/project/project/" class="nav-link">
  项目
</a></li></ul></div></div> <a href="https://github.com/mydb123/My-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/My-notes/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/My-notes/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/front/htmlcss/" class="nav-link">
  HtmlCss
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/javascript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/webapi/" class="nav-link">
  WebAPI
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/jquery/" class="nav-link">
  jQuery
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/react/" class="nav-link router-link-active">
  React
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/front/threejs/" class="nav-link">
  ThreeJs
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/backend/java/" class="nav-link">
  Java
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="移动端" class="dropdown-title"><span class="title">移动端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/mobile/applets/" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/mobile/application/" class="nav-link">
  uni-app
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/tools/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/tools/vscode/" class="nav-link">
  VSCode
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><span class="title">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/others/utils/" class="nav-link">
  Utils
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/others/recording/" class="nav-link">
  随心记
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/others/interview/" class="nav-link">
  面试宝典
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/others/javadeploy/" class="nav-link">
  java配置
</a></li><li class="dropdown-item"><!----> <a href="/My-notes/others/standard/" class="nav-link">
  规范
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/My-notes/project/project/" class="nav-link">
  项目
</a></li></ul></div></div> <a href="https://github.com/mydb123/My-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>REACT</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/My-notes/front/react/" class="sidebar-link">首页</a></li><li><a href="/My-notes/front/react/chapter_01.html" class="sidebar-link">react初始化</a></li><li><a href="/My-notes/front/react/chapter_02.html" class="sidebar-link">使用React</a></li><li><a href="/My-notes/front/react/chapter_03.html" class="sidebar-link">JSX语法</a></li><li><a href="/My-notes/front/react/chapter_04.html" class="sidebar-link">组件创建和传值</a></li><li><a href="/My-notes/front/react/chapter_05.html" class="sidebar-link">class关键字</a></li><li><a href="/My-notes/front/react/chapter_06.html" class="sidebar-link">React案例</a></li><li><a href="/My-notes/front/react/chapter_07.html" class="sidebar-link">React绑定和生命周期</a></li><li><a href="/My-notes/front/react/project_01.html" class="sidebar-link">react项目</a></li><li><a href="/My-notes/front/react/project_02.html" class="sidebar-link">react登录注册</a></li><li><a href="/My-notes/front/react/project_03.html" class="sidebar-link">react登录注册二</a></li><li><a href="/My-notes/front/react/project_04.html" class="sidebar-link">react首页</a></li><li><a href="/My-notes/front/react/project_05.html" class="active sidebar-link">react列表系列</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/My-notes/front/react/project_05.html#自动化工程" class="sidebar-link">自动化工程</a></li><li class="sidebar-sub-header"><a href="/My-notes/front/react/project_05.html#inputnumber" class="sidebar-link">InputNumber</a></li><li class="sidebar-sub-header"><a href="/My-notes/front/react/project_05.html#react-cookies" class="sidebar-link">React-cookies</a></li><li class="sidebar-sub-header"><a href="/My-notes/front/react/project_05.html#解决无法获取token-添加部门接口调试" class="sidebar-link">解决无法获取token,添加部门接口调试</a></li><li class="sidebar-sub-header"><a href="/My-notes/front/react/project_05.html#react接口在componentdidmount来请求" class="sidebar-link">React接口在componentDidMount来请求</a></li><li class="sidebar-sub-header"><a href="/My-notes/front/react/project_05.html#配置路径不用" class="sidebar-link">配置路径不用../../</a></li><li class="sidebar-sub-header"><a href="/My-notes/front/react/project_05.html#部门列表-1" class="sidebar-link">部门列表(1)</a></li><li class="sidebar-sub-header"><a href="/My-notes/front/react/project_05.html#react传参方式-3种" class="sidebar-link">React传参方式(3种)</a></li><li class="sidebar-sub-header"><a href="/My-notes/front/react/project_05.html#删除-编辑" class="sidebar-link">删除/编辑</a></li></ul></li><li><a href="/My-notes/front/react/project_06.html" class="sidebar-link">优化分离组件</a></li><li><a href="/My-notes/front/react/project_07.html" class="sidebar-link">分离组件添加部门</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="自动化工程"><a href="#自动化工程" class="header-anchor">#</a> 自动化工程</h2> <p>注: 由于每次添加左边菜单栏都得更改也就是<code>containerMain/Index.js</code>文件下都得改,比较麻烦</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token comment">//\components\containerMain\components.js</span>
    <span class="token comment">/**自动化工程*/</span>
    <span class="token comment">//建立上下文关系</span>
    <span class="token comment">// const files = require.context(&quot;../../views/&quot;,true,/\.js$/);//第一个参数,目录,第二个参数:是否拆找子级目录,第三参数:指定查找到文件</span>
    <span class="token comment">// //声明组件对象</span>
    <span class="token comment">// const components = [];</span>
    <span class="token comment">// //循环文件</span>
    <span class="token comment">// files.keys().map(key =&gt;{</span>
    <span class="token comment">//         //过滤掉index,login</span>
    <span class="token comment">//     if(key.includes(&quot;./index/&quot;)|| key.includes(&quot;./login/&quot;)){return false;}</span>
    <span class="token comment">//     //分割字符串</span>
    <span class="token comment">//     const splitFilesName = key.split(&quot;.&quot;);</span>
    <span class="token comment">//     const jsonObj = {};</span>
    <span class="token comment">//     //path</span>
    <span class="token comment">//     const path = `/index${splitFilesName[1].toLowerCase()}`;</span>
    <span class="token comment">//     const component =  files(key).default;</span>
    <span class="token comment">//     // 写入对象</span>
    <span class="token comment">//     jsonObj.path = path;</span>
    <span class="token comment">//     jsonObj.component = component;</span>
    <span class="token comment">//     components.push(jsonObj);</span>

    <span class="token comment">// })</span>

    <span class="token comment">// export default components;</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>

    <span class="token comment">//\components\containerMain\Index.js</span>
    <span class="token comment">/**自动化工程*/</span>
    <span class="token comment">// import components from &quot;./components&quot;;</span>

    <span class="token comment">// render(){</span>
    <span class="token comment">//     return(</span>
    <span class="token comment">//         &lt;Switch&gt;</span>
    <span class="token comment">//             {</span>
    <span class="token comment">//                 components.map(item=&gt;{</span>
    <span class="token comment">//                     return &lt;PrivateRouter exact key={item.path} path={item.path}  component={item.component}  /&gt;   </span>
    <span class="token comment">//                 })</span>
    <span class="token comment">//             }</span>
    <span class="token comment">//             {/* &lt;PrivateRouter exact path=&quot;/index/user/list&quot;  component={User}  /&gt;   </span>
    <span class="token comment">//             &lt;PrivateRouter exact path=&quot;/index/user/add&quot;  component={UserAdd}  /&gt;   </span>
    <span class="token comment">//             &lt;PrivateRouter exact path=&quot;/index/department/list&quot;  component={DepartmentList}  /&gt;   </span>
    <span class="token comment">//             &lt;PrivateRouter exact path=&quot;/index/department/add&quot;  component={DepartmentAdd}  /&gt;    */}</span>
    <span class="token comment">//         &lt;/Switch&gt;</span>
           
    <span class="token comment">//     )</span>
    <span class="token comment">// }</span>
</code></pre></div><h2 id="inputnumber"><a href="#inputnumber" class="header-anchor">#</a> InputNumber</h2> <ul><li>专门处理数字的,大部门在form表单里</li></ul> <h2 id="react-cookies"><a href="#react-cookies" class="header-anchor">#</a> React-cookies</h2> <ul><li><p>sessionStorage:生命周期是仅存在当前会话下有效果,也就是当前窗口,只要这个浏览器没用关闭,sessionStorage在关闭了浏览器窗口后就会被销毁</p></li> <li><p>localStorage:生命周期是永久存在的,在关闭页面或者浏览器之后localStorage中的数据也不会消失.localStorage除非主动删除数据,否则数据永远不会消失</p></li> <li><p>cookie:生命周期为只在设置cookie过期时间之前一直有效,即使窗口或者浏览器关闭,存放数据大小为4k左右,有个数限制(各浏览器不一样,一般不超过20个,缺点不能存储大数据且不易读取).</p></li> <li><p>得安装依赖不然能用cookies</p></li> <li><p>npm install react-cookies --save</p></li></ul> <h2 id="解决无法获取token-添加部门接口调试"><a href="#解决无法获取token-添加部门接口调试" class="header-anchor">#</a> 解决无法获取token,添加部门接口调试</h2> <ul><li>添加部门接口</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
   <span class="token comment">//react-admin\src\api\department.js</span>
    <span class="token comment">// import service from &quot;../../src/utils/requets&quot;;</span>

    <span class="token comment">// /**</span>
    <span class="token comment">// * 添加部门接口</span>
    <span class="token comment">// */</span>
    <span class="token comment">// export function DepartmentAdd(data){</span>
    <span class="token comment">//     return service.request({</span>
    <span class="token comment">//         url:&quot;/department/add/&quot;,</span>
    <span class="token comment">//         method:&quot;post&quot;,</span>
    <span class="token comment">//         data, //请求了类型为post时</span>
    <span class="token comment">//     })</span>
    <span class="token comment">// }</span>

</code></pre></div><ul><li>修改react-router的路径</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">// react-admin\src\components\privateRouter\index.js</span>
    <span class="token comment">// import React from &quot;react&quot;;</span>

    <span class="token comment">// import {Redirect, Route} from &quot;react-router-dom&quot;;</span>

    <span class="token comment">// //token</span>
    <span class="token comment">// import {getToken} from &quot;../../utils/cookies&quot;;</span>
    <span class="token comment">// const PrivateRouter = ({ component: Component, ...rest }) =&gt;{</span>
    <span class="token comment">//     return (</span>
    <span class="token comment">//     &lt;Route</span>
    <span class="token comment">//         {...rest}</span>
    <span class="token comment">//         render={routeProps =&gt; (</span>
    <span class="token comment">//             getToken() ? &lt;Component {...routeProps} /&gt; :&lt;Redirect to=&quot;/&quot;/&gt;</span>
    <span class="token comment">//         )}</span>
    <span class="token comment">//     /&gt;</span>
    <span class="token comment">//     );</span>
    <span class="token comment">// }</span>

    <span class="token comment">// export default PrivateRouter;</span>

</code></pre></div><ul><li>新增文件cookies文件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">//react-admin\src\utils\cookies.js</span>
    <span class="token comment">// import cookies from &quot;react-cookies&quot;;</span>

    <span class="token comment">// const token = &quot;adminToken&quot;;</span>
    <span class="token comment">// const user = &quot;username&quot;;</span>

    <span class="token comment">// //存储token</span>
    <span class="token comment">// export function setToken(value){</span>
    <span class="token comment">//     cookies.save(token,value)</span>
    <span class="token comment">// }</span>
    <span class="token comment">// export function getToken(){</span>
    <span class="token comment">//     return cookies.load(token)</span>
    <span class="token comment">// }</span>



    <span class="token comment">//存储用户名</span>
<span class="token comment">//     export function sutUsername(value){</span>
<span class="token comment">//         cookies.save(user,value)</span>
<span class="token comment">//     }</span>


<span class="token comment">//     export function getUsername(){</span>
<span class="token comment">//         return cookies.load(user)</span>
<span class="token comment">// }</span>


</code></pre></div><ul><li>修改请求部门</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token comment">//\react-admin\src\utils\requets.js</span>
    <span class="token comment">//第二部: 请求拦截(请求头)</span>
  <span class="token comment">//  service.interceptors.request.use(function (config) {</span>



<span class="token comment">//--------------------------------------------------</span>
        <span class="token comment">// 在发送请求之前做些什么 Token,Username</span>
       <span class="token comment">// config.headers[&quot;Token&quot;] = getToken();</span>
        <span class="token comment">//config.headers[&quot;Username&quot;] = getUsername();</span>
<span class="token comment">//--------------------------------------------------</span>




    <span class="token comment">//     return config;</span>
    <span class="token comment">// }, function (error) {</span>
    <span class="token comment">//     // 对请求错误做些什么</span>
    <span class="token comment">//     return Promise.reject(error);</span>
    <span class="token comment">// });</span>


</code></pre></div><ul><li>添加部门页面(主体)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token comment">//react-admin\src\views\department\Add.js</span>
    <span class="token comment">//部门管理-添加部门</span>
    <span class="token comment">// import React,{Component} from &quot;react&quot;;</span>

    <span class="token comment">// //ANTD</span>
    <span class="token comment">// import{Form, Input,Button, InputNumber,Radio,message} from 'antd';</span>

    <span class="token comment">// //API</span>
    <span class="token comment">// import { DepartmentAdd } from &quot;../../api/department&quot;;</span>

    <span class="token comment">// class AddDepartment extends Component{</span>
    <span class="token comment">//     constructor(props){</span>
    <span class="token comment">//         super();</span>
    <span class="token comment">//         this.state={</span>
    <span class="token comment">//             loading:false,</span>
    <span class="token comment">//             fromLayout:{</span>
    <span class="token comment">//                 labelCol:{span:2} ,</span>
    <span class="token comment">//                 wrapperCol:{span:20} </span>
    <span class="token comment">//             }</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//     }</span>

    <span class="token comment">//     onSubmit = (v) =&gt;{</span>
    <span class="token comment">//         if(!v.name){</span>
    <span class="token comment">//             message.error(&quot;部门不能为空&quot;);</span>
    <span class="token comment">//             return false;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         if(!v.number|| v.number ===0){</span>
    <span class="token comment">//             message.error(&quot;人员数量不能为0&quot;);</span>
    <span class="token comment">//             return false;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         if(!v.content){</span>
    <span class="token comment">//             message.error(&quot;描述不能为空&quot;);</span>
    <span class="token comment">//             return false;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         this.setState({</span>
    <span class="token comment">//             loading:true,</span>
    <span class="token comment">//         })</span>
    <span class="token comment">//         DepartmentAdd(v).then(response=&gt;{</span>
    <span class="token comment">//             // console.log(response);</span>
    <span class="token comment">//             const data = response.data;</span>
    <span class="token comment">//             message.info(data.message);</span>
    <span class="token comment">//             this.setState({</span>
    <span class="token comment">//                 loading:false,</span>
    <span class="token comment">//             })</span>
    <span class="token comment">//             //重置表单</span>
    <span class="token comment">//             this.refs.form.resetFields();</span>
    <span class="token comment">//         }).catch(error=&gt;{</span>
    <span class="token comment">//             this.setState({</span>
    <span class="token comment">//                 loading:false,</span>
    <span class="token comment">//             })</span>
    <span class="token comment">//         })</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//     render() {</span>
    <span class="token comment">//         return(</span>
    <span class="token comment">//             // 老式写法</span>
    <span class="token comment">//             // &lt;Form onFinish={this.onSubmit} labelCol={this.state.fromLayout.labelCol} wrapperCol={this.state.fromLayout.wrapperCol}&gt;&lt;/Form&gt;</span>
    <span class="token comment">//             // es6扩展</span>
    <span class="token comment">//             &lt;Form </span>
    <span class="token comment">//             ref=&quot;form&quot;</span>
    <span class="token comment">//             onFinish={this.onSubmit}</span>
    <span class="token comment">//             {...this.state.fromLayout} </span>
    <span class="token comment">//             initialValues={{status:true,number:0}}</span>
    <span class="token comment">//             &gt;</span>
    <span class="token comment">//                 &lt;Form.Item label=&quot;部门名称&quot; name=&quot;name&quot;&gt;</span>
    <span class="token comment">//                     &lt;Input /&gt;</span>
    <span class="token comment">//                 &lt;/Form.Item&gt;</span>
    <span class="token comment">//                 &lt;Form.Item label=&quot;人员熟量&quot; name=&quot;number&quot;&gt;</span>
    <span class="token comment">//                     &lt;InputNumber min={0} max={100}   /&gt;</span>
    <span class="token comment">//                 &lt;/Form.Item&gt;</span>
    <span class="token comment">//                 &lt;Form.Item label=&quot;禁启用&quot; name=&quot;status&quot;&gt;</span>
    <span class="token comment">//                     &lt;Radio.Group  &gt;</span>
    <span class="token comment">//                         &lt;Radio value={true}&gt;启用&lt;/Radio&gt;</span>
    <span class="token comment">//                         &lt;Radio value={false}&gt;禁用&lt;/Radio&gt;</span>
    <span class="token comment">//                     &lt;/Radio.Group&gt;</span>
    <span class="token comment">//                 &lt;/Form.Item&gt;</span>
    <span class="token comment">//                 &lt;Form.Item label=&quot;描述&quot; name=&quot;content&quot;&gt;</span>
    <span class="token comment">//                     &lt;Input.TextArea /&gt;</span>
    <span class="token comment">//                 &lt;/Form.Item&gt;</span>
    <span class="token comment">//                 &lt;Button loading={this.state.loading} type=&quot;primary&quot; htmlType=&quot;submit&quot;&gt;提交&lt;/Button&gt;</span>
    <span class="token comment">//             &lt;/Form&gt;</span>
    <span class="token comment">//         )</span>
    <span class="token comment">//     }</span>
    <span class="token comment">// }</span>

    <span class="token comment">// export default AddDepartment;</span>


</code></pre></div><ul><li>两处修改</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
   <span class="token comment">//react-admin\src\views\login\LoginFrom.js</span>
    <span class="token comment">// import {setToken,sutUsername} from &quot;../../utils/cookies&quot;;</span>


    <span class="token comment">// Login(resquesData).then(response=&gt;{</span>
    <span class="token comment">//         this.setState({</span>
    <span class="token comment">//             loading:true,</span>
    <span class="token comment">//         })</span>
    <span class="token comment">//         //路由跳转</span>
    <span class="token comment">//         const data = response.data.data;</span>
    <span class="token comment">//         setToken(data.token);</span>


<span class="token comment">//------------------------------</span>

            <span class="token comment">// sutUsername(data.username)</span>

<span class="token comment">//------------------------------</span>




        <span class="token comment">//     this.props.history.push(&quot;/index&quot;);</span>
        <span class="token comment">// }).catch(error=&gt;{</span>
        <span class="token comment">//     this.setState({</span>
        <span class="token comment">//         loading:true,</span>
        <span class="token comment">//     })</span>
        <span class="token comment">// })</span>

</code></pre></div><h2 id="react接口在componentdidmount来请求"><a href="#react接口在componentdidmount来请求" class="header-anchor">#</a> React接口在<code>componentDidMount</code>来请求</h2> <ul><li><p>基本生命周期: constructor() --&gt; componentWillMount()----&gt;render()----&gt;<code>componentDidMount()</code></p></li> <li><p>constructor被调用是在组件准备要挂载的最开始,此时组件尚未挂载到网页上.</p></li> <li><p>componentWillMount 在constructor之后,在render之前,在这方法里的代码调用setState方法不会触发重新render,所以不会用来作加载数据之用</p></li> <li><p><code>componentDidMount</code>方法里的代码,是在组件已经完全挂载到网页上才会调用被执行.所以可以保证数据的加载</p></li></ul> <h2 id="配置路径不用"><a href="#配置路径不用" class="header-anchor">#</a> 配置路径不用../../</h2> <ul><li>到<code>config/webpack.config.js</code>文件里搜索<code>alias</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">//  alias: {</span>
    <span class="token comment">//     '@': path.resolve('src'),</span>
    <span class="token comment">//     '@c': path.resolve('src/components'),</span>
    <span class="token comment">//     '@api': path.resolve('src/api'),</span>
    <span class="token comment">//     // Support React Native Web</span>
    <span class="token comment">//     // https://www.smashingmagazine.com/2016/08/a-glimpse-into-the-future-with-react-native-for-web/</span>
    <span class="token comment">//     'react-native': 'react-native-web',</span>
    <span class="token comment">//     // Allows for better profiling with ReactDevTools</span>
    <span class="token comment">//     ...(isEnvProductionProfile &amp;&amp; {</span>
    <span class="token comment">//       'react-dom$': 'react-dom/profiling',</span>
    <span class="token comment">//       'scheduler/tracing': 'scheduler/tracing-profiling',</span>
    <span class="token comment">//     }),</span>
    <span class="token comment">//     ...(modules.webpackAliases || {}),</span>
    <span class="token comment">//   },</span>

</code></pre></div><h2 id="部门列表-1"><a href="#部门列表-1" class="header-anchor">#</a> 部门列表(1)</h2> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">//src\api\department.js</span>
    <span class="token comment">/**
    * 部门列表
    */</span>
    <span class="token comment">// export function GetList(data){</span>
    <span class="token comment">//     return service.request({</span>
    <span class="token comment">//         url:&quot;/department/list/&quot;,</span>
    <span class="token comment">//         method:&quot;post&quot;,</span>
    <span class="token comment">//         data, //请求了类型为post时</span>
    <span class="token comment">//     })</span>
    <span class="token comment">// }</span>

    <span class="token comment">// /**</span>
    <span class="token comment">// * 删除列表一行</span>
    <span class="token comment">// */</span>
    <span class="token comment">// export function Delete(data){</span>
    <span class="token comment">//     return service.request({</span>
    <span class="token comment">//         url:&quot;/department/delete/&quot;,</span>
    <span class="token comment">//         method:&quot;post&quot;,</span>
    <span class="token comment">//         data, //请求了类型为post时</span>
    <span class="token comment">//     })</span>
    <span class="token comment">// }</span>

    <span class="token comment">// //---------------------------------全局错误拦截------------------------------------------------------------</span>
    <span class="token comment">// //ANTD</span>
    <span class="token comment">// import{message} from 'antd';</span>

    <span class="token comment">// //第三步: 响应拦截(响应头)</span>
    <span class="token comment">// service.interceptors.response.use(function (response) {</span>
    <span class="token comment">//     // 对响应数据做点什么</span>
    <span class="token comment">//     // console.log(response);</span>
    <span class="token comment">//     const data = response.data</span>
    <span class="token comment">//     if(data.resCode !==0){ //rescode不成功 全局错误拦截</span>
    <span class="token comment">//         message.info(data.message);</span>
    <span class="token comment">//         return  Promise.reject(response);</span>
    <span class="token comment">//     }else{ //resCode成功</span>
    <span class="token comment">//         return response;</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//     return response;</span>
    <span class="token comment">// }, function (error) {</span>
    <span class="token comment">//     // 对响应错误做点什么</span>
    <span class="token comment">//     return Promise.reject(error);</span>
    <span class="token comment">// });</span>

</code></pre></div><p>+部门列表页面</p> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">//src\views\department\List.js</span>
    <span class="token comment">// import React,{Component,Fragment}from &quot;react&quot;;</span>


    <span class="token comment">// //ANTD</span>
    <span class="token comment">// import {Form ,Input,Button, Table,Switch, message}from &quot;antd&quot;;</span>
    <span class="token comment">// // API</span>
    <span class="token comment">// import {GetList,Delete} from &quot;../../api/department&quot;;</span>
    <span class="token comment">// class DepartmentList extends Component{</span>
    <span class="token comment">//     constructor(props){</span>
    <span class="token comment">//         super();</span>
    <span class="token comment">//         this.state = {</span>
    <span class="token comment">//             //请求参数</span>
    <span class="token comment">//             pageNumber:1, //页数</span>
    <span class="token comment">//             pageSize:10, //显示多少条</span>
    <span class="token comment">//             keyWork:&quot;&quot;,</span>
    <span class="token comment">//             selectedRowKeys:[],//复选框</span>
    <span class="token comment">//             // 表头</span>
    <span class="token comment">//             columns:[</span>
    <span class="token comment">//                 { title:&quot;部门名称&quot;,dataIndex:&quot;name&quot;,key:&quot;name&quot;},</span>
    <span class="token comment">//                 { </span>
    <span class="token comment">//                     title:&quot;禁启用&quot;,</span>
    <span class="token comment">//                     dataIndex:&quot;status&quot;,</span>
    <span class="token comment">//                     key:&quot;status&quot;,</span>
    <span class="token comment">//                     render:(text,rowData)=&gt;{</span>
    <span class="token comment">//                         return &lt;Switch checkedChildren=&quot;开启&quot; unCheckedChildren=&quot;关闭&quot; defaultChecked={rowData.status ===&quot;1&quot;? true : false }&gt;&lt;/Switch&gt;</span>
    <span class="token comment">//                     }</span>
    <span class="token comment">//                 },</span>
    <span class="token comment">//                 { title:&quot;人员数量&quot;,dataIndex:&quot;number&quot;,key:&quot;number&quot;},</span>
    <span class="token comment">//                 { </span>
    <span class="token comment">//                     title:&quot;操作&quot;,</span>
    <span class="token comment">//                     dataIndex:&quot;operation&quot;,</span>
    <span class="token comment">//                     key:&quot;operation&quot;,</span>
    <span class="token comment">//                     width:215,</span>
    <span class="token comment">//                     render:(text,rowData)=&gt;{</span>
    <span class="token comment">//                     return(</span>
    <span class="token comment">//                         &lt;div className=&quot;inline-button&quot;&gt;</span>
    <span class="token comment">//                             &lt;Button type=&quot;primary&quot;&gt;编辑&lt;/Button&gt;</span>
    <span class="token comment">//                             &lt;Button type=&quot;danger&quot; onClick={()=&gt;this.onHandlerDelete(rowData.id)}&gt;删除&lt;/Button&gt;</span>
    <span class="token comment">//                         &lt;/div&gt;</span>
    <span class="token comment">//                     ) </span>
    <span class="token comment">//                     }</span>
    <span class="token comment">//                 },</span>
    <span class="token comment">//             ],</span>
    <span class="token comment">//             //表的数据</span>
    <span class="token comment">//             data:[</span>
                    
    <span class="token comment">//             ]</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//     }</span>



    <span class="token comment">//     //生命周期挂载完成</span>
    <span class="token comment">//     componentDidMount = ()=&gt;{</span>
    <span class="token comment">//         this.loaddata()</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//     //获取数据</span>
    <span class="token comment">//     loaddata = ()=&gt;{</span>
    <span class="token comment">//         const {pageNumber,pageSize,keyWork} = this.state</span>
    <span class="token comment">//         const requestData = {</span>
    <span class="token comment">//             pageNumber:pageNumber,</span>
    <span class="token comment">//             pageSize:pageSize,</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         if(keyWork){ requestData.name = keyWork }</span>
    <span class="token comment">//         GetList(requestData).then(response=&gt;{</span>
    <span class="token comment">//             const responseData = response.data.data</span>
    <span class="token comment">//         //   console.log(response);</span>
    <span class="token comment">//         if(responseData.data){</span>
    <span class="token comment">//             this.setState({</span>
    <span class="token comment">//                 data:responseData.data</span>
    <span class="token comment">//             })</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         })</span>
    <span class="token comment">//     }</span>

    <span class="token comment">//     // 搜索</span>
    <span class="token comment">//     onFinish=(value)=&gt;{</span>
    <span class="token comment">//         this.setState({</span>
    <span class="token comment">//             keyWork:value.name,</span>
    <span class="token comment">//             pageNumber:1, </span>
    <span class="token comment">//             pageSize:10, </span>
                
    <span class="token comment">//         })</span>
    <span class="token comment">//         // //重新获取数据</span>
    <span class="token comment">//         this.loaddata()</span>
    <span class="token comment">//         // console.log(111);</span>
        
    <span class="token comment">//     }</span>
    <span class="token comment">//     /**复选框 */</span>
    <span class="token comment">//     onChangebox = (selectedRowKeys )=&gt;{</span>
    <span class="token comment">//         this.setState({</span>
    <span class="token comment">//             selectedRowKeys</span>
    <span class="token comment">//         })</span>
    <span class="token comment">//         // console.log(selectedRowKeys);</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//     //删除</span>
    <span class="token comment">//     onHandlerDelete = (id) =&gt;{</span>
    <span class="token comment">//         // console.log(id);</span>
    <span class="token comment">//         if(id){</span>
    <span class="token comment">//             return false;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         Delete({id:id}).then(response=&gt;{</span>
    <span class="token comment">//             // console.log(response);</span>
    <span class="token comment">//             message.info(response.data.message);</span>
    <span class="token comment">//             //请求数据</span>
    <span class="token comment">//             this.loaddata();</span>
    <span class="token comment">//         })</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//     render(){</span>
    <span class="token comment">//         const {columns,data} = this.state</span>
    <span class="token comment">//         const rowSelection = {</span>
    <span class="token comment">//             onChange: this.onChangebox</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         return(</span>
    <span class="token comment">//             &lt;Fragment&gt;</span>
    <span class="token comment">//                 &lt;Form layout=&quot;inline&quot; onFinish={this.onFinish}&gt;</span>
    <span class="token comment">//                     &lt;Form.Item label=&quot;部门名称&quot;  name=&quot;name&quot;  &gt;</span>
    <span class="token comment">//                         &lt;Input placeholder=&quot;请输入部门名称&quot; /&gt;</span>
    <span class="token comment">//                     &lt;/Form.Item&gt;</span>
    <span class="token comment">//                     &lt;Form.Item shouldUpdate={true}  &gt;</span>
    <span class="token comment">//                         &lt;Button type=&quot;primary&quot; htmlType=&quot;submit&quot;&gt;</span>
    <span class="token comment">//                             搜索</span>
    <span class="token comment">//                         &lt;/Button&gt;</span>
    <span class="token comment">//                     &lt;/Form.Item&gt;</span>
    <span class="token comment">//                 &lt;/Form&gt;</span>
    <span class="token comment">//                 &lt;div className=&quot;table-wrap&quot;&gt;</span>
    <span class="token comment">//                     &lt;Table rowSelection={rowSelection} rowKey =&quot;id&quot; columns={columns} dataSource={data} bordered&gt;  &lt;/Table&gt;</span>
    <span class="token comment">//                 &lt;/div&gt;</span>
    <span class="token comment">//             &lt;/Fragment&gt;</span>
    <span class="token comment">//         )</span>
    <span class="token comment">//     }</span>
    <span class="token comment">// }</span>

    <span class="token comment">// export default DepartmentList;</span>


</code></pre></div><h2 id="react传参方式-3种"><a href="#react传参方式-3种" class="header-anchor">#</a> React传参方式(3种)</h2> <ol><li>params传参(刷新页面后参数不消失,参数在地址栏里显示)
</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">//react\react-admin\src\views\department\List.js</span>
    <span class="token comment">// import {Link} from &quot;react-react-dom&quot;;</span>


    <span class="token comment">// { </span>
    <span class="token comment">//     title:&quot;操作&quot;,</span>
    <span class="token comment">//     dataIndex:&quot;operation&quot;,</span>
    <span class="token comment">//     key:&quot;operation&quot;,</span>
    <span class="token comment">//     width:215,</span>
    <span class="token comment">//     render:(text,rowData)=&gt;{</span>
    <span class="token comment">//         return(</span>
    <span class="token comment">//         &lt;div className=&quot;inline-button&quot;&gt;</span>
    <span class="token comment">//             &lt;Button type=&quot;primary&quot; onClick={()=&gt;this.onHandlerEdit(rowData.id)}&gt;</span>
    <span class="token comment">//                 &lt;Link to={'/index/department/add?id='+rowData.id}&gt;编辑&lt;/Link&gt;</span>
    <span class="token comment">//             &lt;/Button&gt;</span>
    <span class="token comment">//         &lt;/div&gt;</span>
    <span class="token comment">//     ) </span>
    <span class="token comment">//     }</span>
    <span class="token comment">// },</span>

    <span class="token comment">//  //react\react-admin\src\views\department\Add.js</span>
    <span class="token comment">// componentDidMount(){</span>
    <span class="token comment">//     console.log(this.props.location.state.id);</span>
    <span class="token comment">// }</span>

</code></pre></div><ol start="2"><li>query传参(刷新页面参数消失)</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">// //react\react-admin\src\views\department\List.js</span>
    <span class="token comment">// import {Link} from &quot;react-react-dom&quot;;</span>


    <span class="token comment">// { </span>
    <span class="token comment">//     title:&quot;操作&quot;,</span>
    <span class="token comment">//     dataIndex:&quot;operation&quot;,</span>
    <span class="token comment">//     key:&quot;operation&quot;,</span>
    <span class="token comment">//     width:215,</span>
    <span class="token comment">//     render:(text,rowData)=&gt;{</span>
    <span class="token comment">//         return(</span>
    <span class="token comment">//         &lt;div className=&quot;inline-button&quot;&gt;</span>
    <span class="token comment">//             &lt;Button type=&quot;primary&quot; onClick={()=&gt;this.onHandlerEdit(rowData.id)}&gt;</span>
    <span class="token comment">//                 &lt;Link to={{pathname:&quot;/index/department/add&quot;,query:{id:rowData.id}}}&gt;编辑&lt;/Link&gt;</span>
    <span class="token comment">//             &lt;/Button&gt;</span>
    <span class="token comment">//         &lt;/div&gt;</span>
    <span class="token comment">//     ) </span>
    <span class="token comment">//     }</span>
    <span class="token comment">// },</span>

    <span class="token comment">//  //react\react-admin\src\views\department\Add.js</span>
    <span class="token comment">// componentDidMount(){</span>
    <span class="token comment">//     console.log(this.props.location.query.id);</span>
    <span class="token comment">// }</span>

</code></pre></div><ol start="2"><li>query传参(刷新页面参数不消失,state传参是加密的)</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">//react\react-admin\src\views\department\List.js</span>
    <span class="token comment">// import {Link} from &quot;react-react-dom&quot;;</span>


    <span class="token comment">// { </span>
    <span class="token comment">//     title:&quot;操作&quot;,</span>
    <span class="token comment">//     dataIndex:&quot;operation&quot;,</span>
    <span class="token comment">//     key:&quot;operation&quot;,</span>
    <span class="token comment">//     width:215,</span>
    <span class="token comment">//     render:(text,rowData)=&gt;{</span>
    <span class="token comment">//         return(</span>
    <span class="token comment">//         &lt;div className=&quot;inline-button&quot;&gt;</span>
    <span class="token comment">//             &lt;Button type=&quot;primary&quot; onClick={()=&gt;this.onHandlerEdit(rowData.id)}&gt;</span>
    <span class="token comment">//                 &lt;Link to={{pathname:&quot;/index/department/add&quot;,sate:{id:rowData.id}}}&gt;编辑&lt;/Link&gt;</span>
    <span class="token comment">//             &lt;/Button&gt;</span>
    <span class="token comment">//         &lt;/div&gt;</span>
    <span class="token comment">//     ) </span>
    <span class="token comment">//     }</span>
    <span class="token comment">// },</span>

    <span class="token comment">//  //react\react-admin\src\views\department\Add.js</span>
    <span class="token comment">// componentDidMount(){</span>
    <span class="token comment">//     console.log(this.props.location.sate.id);</span>
    <span class="token comment">// }</span>

</code></pre></div><h2 id="删除-编辑"><a href="#删除-编辑" class="header-anchor">#</a> 删除/编辑</h2> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">//src\api\department.js</span>
    <span class="token comment">//新增三个接口</span>
    <span class="token comment">/**
    * 禁用启用切换
    */</span>
    <span class="token comment">// export function Status(data){</span>
    <span class="token comment">//     return service.request({</span>
    <span class="token comment">//         url:&quot;/department/status/&quot;,</span>
    <span class="token comment">//         method:&quot;post&quot;,</span>
    <span class="token comment">//         data, //请求了类型为post时</span>
    <span class="token comment">//     })</span>
    <span class="token comment">// }</span>

    <span class="token comment">// /**</span>
    <span class="token comment">// * 详情</span>
    <span class="token comment">// */</span>
    <span class="token comment">// export function Detailed(data){</span>
    <span class="token comment">//     return service.request({</span>
    <span class="token comment">//         url:&quot;/department/detailed/&quot;,</span>
    <span class="token comment">//         method:&quot;post&quot;,</span>
    <span class="token comment">//         data, //请求了类型为post时</span>
    <span class="token comment">//     })</span>
    <span class="token comment">// }</span>

    <span class="token comment">// /**</span>
    <span class="token comment">// * 编辑</span>
    <span class="token comment">// */</span>
    <span class="token comment">// export function Edit(data){</span>
    <span class="token comment">//     return service.request({</span>
    <span class="token comment">//         url:&quot;/department/edit/&quot;,</span>
    <span class="token comment">//         method:&quot;post&quot;,</span>
    <span class="token comment">//         data, //请求了类型为post时</span>
    <span class="token comment">//     })</span>
    <span class="token comment">// }</span>

</code></pre></div><ul><li>列表页面</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">//src\views\department\List.js</span>
    <span class="token comment">// import React,{Component,Fragment}from &quot;react&quot;;</span>



    <span class="token comment">//*********************************************************************************************</span>
    <span class="token comment">//ANTD</span>
    <span class="token comment">// import {Form ,Input,Button, Table,Switch, message,Modal}from &quot;antd&quot;;</span>
    <span class="token comment">// // API</span>
    <span class="token comment">// import {GetList,Delete,Status} from &quot;../../api/department&quot;;</span>
    <span class="token comment">// import { Link } from &quot;react-router-dom&quot;;</span>
    <span class="token comment">//*********************************************************************************************</span>




    <span class="token comment">// class DepartmentList extends Component{</span>
    <span class="token comment">//     constructor(props){</span>
    <span class="token comment">//         super();</span>
    <span class="token comment">//         this.state = {</span>
    <span class="token comment">//             //请求参数</span>
    <span class="token comment">//             pageNumber:1, //页数</span>
    <span class="token comment">//             pageSize:10, //显示多少条</span>
    <span class="token comment">//             keyWork:&quot;&quot;,</span>


    <span class="token comment">//*********************************************************************************************</span>

                <span class="token comment">// selectedRowKeys:[],//复选框</span>
                <span class="token comment">// visible:false,// 删除警告弹框</span>
                <span class="token comment">// showPromiseConfirm:false,// 堂创确定按钮</span>
                <span class="token comment">// id:&quot;&quot;,</span>
    <span class="token comment">//*********************************************************************************************</span>



                <span class="token comment">// 表头</span>
                <span class="token comment">// columns:[</span>
                <span class="token comment">//     { title:&quot;部门名称&quot;,dataIndex:&quot;name&quot;,key:&quot;name&quot;},</span>
                <span class="token comment">//     { </span>
                <span class="token comment">//         title:&quot;禁启用&quot;,</span>
                <span class="token comment">//         dataIndex:&quot;status&quot;,</span>
                <span class="token comment">//         key:&quot;status&quot;,</span>
                <span class="token comment">//         render:(text,rowData)=&gt;{</span>


    <span class="token comment">//*********************************************************************************************</span>

                            <span class="token comment">// return &lt;Switch onChange={()=&gt;this.onHandSwitch(rowData)} checkedChildren=&quot;开启&quot; unCheckedChildren=&quot;关闭&quot; defaultChecked={rowData.status ===&quot;1&quot;? true : false }&gt;&lt;/Switch&gt;</span>
    <span class="token comment">//*********************************************************************************************</span>



                    <span class="token comment">//     }</span>
                    <span class="token comment">// },</span>
                    <span class="token comment">// { title:&quot;人员数量&quot;,dataIndex:&quot;number&quot;,key:&quot;number&quot;},</span>
                    <span class="token comment">// { </span>
                    <span class="token comment">//     title:&quot;操作&quot;,</span>
                    <span class="token comment">//     dataIndex:&quot;operation&quot;,</span>
                    <span class="token comment">//     key:&quot;operation&quot;,</span>
                    <span class="token comment">//     width:215,</span>
                    <span class="token comment">//     render:(text,rowData)=&gt;{</span>
                    <span class="token comment">//     return(</span>
                    <span class="token comment">//         &lt;div className=&quot;inline-button&quot;&gt;</span>

    <span class="token comment">// *********************************************************************************************</span>

                                <span class="token comment">// &lt;Button type=&quot;primary&quot;&gt;</span>
                                <span class="token comment">//     &lt;Link to={{pathname:&quot;/index/department/add&quot;,state:{id:rowData.id}}}&gt;编辑&lt;/Link&gt;</span>
                                <span class="token comment">// &lt;/Button&gt;</span>
                                <span class="token comment">// &lt;Button type=&quot;danger&quot; onClick={()=&gt;this.onHandlerDelete(rowData.id)}&gt;删除&lt;/Button&gt;</span>
    <span class="token comment">//*********************************************************************************************</span>

        <span class="token comment">//                     &lt;/div&gt;</span>
        <span class="token comment">//                 ) </span>
        <span class="token comment">//                 }</span>
        <span class="token comment">//             },</span>
        <span class="token comment">//         ],</span>
        <span class="token comment">//         //表的数据</span>
        <span class="token comment">//         data:[</span>
                    
        <span class="token comment">//         ]</span>
        <span class="token comment">//     }</span>
        <span class="token comment">// }</span>



        <span class="token comment">//生命周期挂载完成</span>
        <span class="token comment">// componentDidMount = ()=&gt;{</span>
        <span class="token comment">//     this.loaddata()</span>
        <span class="token comment">// }</span>
        <span class="token comment">// //获取数据</span>
        <span class="token comment">// loaddata = ()=&gt;{</span>
        <span class="token comment">//     const {pageNumber,pageSize,keyWork} = this.state</span>
        <span class="token comment">//     const requestData = {</span>
        <span class="token comment">//         pageNumber:pageNumber,</span>
        <span class="token comment">//         pageSize:pageSize,</span>
        <span class="token comment">//     }</span>
        <span class="token comment">//     if(keyWork){ requestData.name = keyWork }</span>
        <span class="token comment">//     GetList(requestData).then(response=&gt;{</span>
        <span class="token comment">//         const responseData = response.data.data</span>
        <span class="token comment">//     //   console.log(response);</span>
        <span class="token comment">//     if(responseData.data){</span>
        <span class="token comment">//         this.setState({</span>
        <span class="token comment">//             data:responseData.data</span>
        <span class="token comment">//         })</span>
        <span class="token comment">//     }</span>
        <span class="token comment">//     })</span>
        <span class="token comment">// }</span>

        <span class="token comment">// // 搜索</span>
        <span class="token comment">// onFinish=(value)=&gt;{</span>
        <span class="token comment">//     this.setState({</span>
        <span class="token comment">//         keyWork:value.name,</span>
        <span class="token comment">//         pageNumber:1, </span>
        <span class="token comment">//         pageSize:10, </span>
                
        <span class="token comment">//     })</span>
        <span class="token comment">//     // //重新获取数据</span>
        <span class="token comment">//     this.loaddata()</span>
        <span class="token comment">//     // console.log(111);</span>
        
        <span class="token comment">// }</span>
        <span class="token comment">// /**复选框 */</span>
        <span class="token comment">// onChangebox = (selectedRowKeys )=&gt;{</span>
        <span class="token comment">//     this.setState({</span>
        <span class="token comment">//         selectedRowKeys</span>
        <span class="token comment">//     })</span>
        <span class="token comment">//     // console.log(selectedRowKeys);</span>
        <span class="token comment">// }</span>

    <span class="token comment">//*********************************************************************************************</span>

        <span class="token comment">//删除</span>
    <span class="token comment">//     onHandlerDelete(id){</span>
    <span class="token comment">//         // console.log(id);</span>
    <span class="token comment">//         if(!id){</span>
    <span class="token comment">//             return false;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         this.setState({</span>
    <span class="token comment">//             visible:true,</span>
    <span class="token comment">//             id</span>
    <span class="token comment">//         })</span>
        
    <span class="token comment">//     }</span>
    <span class="token comment">//     /**删除警告弹框 */</span>
    <span class="token comment">//     modalThen=()=&gt;{</span>
    <span class="token comment">//         Delete({id:this.state.id}).then(response=&gt;{</span>
    <span class="token comment">//             // console.log(response);</span>
    <span class="token comment">//             message.info(response.data.message);</span>
    <span class="token comment">//             this.setState({</span>
    <span class="token comment">//                 visible:false,</span>
    <span class="token comment">//                 id:&quot;&quot;,</span>
    <span class="token comment">//                 showPromiseConfirm:false</span>
    <span class="token comment">//             })</span>
    <span class="token comment">//             //请求数据</span>
    <span class="token comment">//             this.loaddata();</span>

    <span class="token comment">//         })</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//     //禁用启用</span>
    <span class="token comment">//     onHandSwitch(data){</span>
    <span class="token comment">//         if(!data.status){return false;}</span>
    <span class="token comment">//         const requesData = {</span>
    <span class="token comment">//             id:data.id,</span>
    <span class="token comment">//             status:data.status === &quot;1&quot;?false:true</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         Status().then(response =&gt;{</span>
    <span class="token comment">//             message.info(response.data.message)</span>
    <span class="token comment">//         })</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//     //编辑</span>
    <span class="token comment">// //*********************************************************************************************</span>

    <span class="token comment">//     render(){</span>
    <span class="token comment">//         const {columns,data} = this.state</span>
    <span class="token comment">//         const rowSelection = {</span>
    <span class="token comment">//             onChange: this.onChangebox</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         return(</span>
    <span class="token comment">//             &lt;Fragment&gt;</span>
    <span class="token comment">//                 &lt;Form layout=&quot;inline&quot; onFinish={this.onFinish}&gt;</span>
    <span class="token comment">//                     &lt;Form.Item label=&quot;部门名称&quot;  name=&quot;name&quot;  &gt;</span>
    <span class="token comment">//                         &lt;Input placeholder=&quot;请输入部门名称&quot; /&gt;</span>
    <span class="token comment">//                     &lt;/Form.Item&gt;</span>
    <span class="token comment">//                     &lt;Form.Item shouldUpdate={true}  &gt;</span>
    <span class="token comment">//                         &lt;Button type=&quot;primary&quot; htmlType=&quot;submit&quot;&gt;</span>
    <span class="token comment">//                             搜索</span>
    <span class="token comment">//                         &lt;/Button&gt;</span>
    <span class="token comment">//                     &lt;/Form.Item&gt;</span>
    <span class="token comment">//                 &lt;/Form&gt;</span>
    <span class="token comment">//                 &lt;div className=&quot;table-wrap&quot;&gt;</span>
    <span class="token comment">//                     &lt;Table rowSelection={rowSelection} rowKey =&quot;id&quot; columns={columns} dataSource={data} bordered&gt;  &lt;/Table&gt;</span>
    <span class="token comment">//                 &lt;/div&gt;</span>


    <span class="token comment">// //*********************************************************************************************</span>

    <span class="token comment">//                 &lt;Modal</span>
    <span class="token comment">//                     title=&quot;提示&quot;</span>
    <span class="token comment">//                     visible={this.state.visible}</span>
    <span class="token comment">//                     onOk={this.modalThen}</span>
    <span class="token comment">//                     onCancel={()=&gt;{this.setState({visible:false})}}</span>
    <span class="token comment">//                     showPromiseConfirm={this.state.showPromiseConfirm}</span>
    <span class="token comment">//                     okText=&quot;确认&quot;</span>
    <span class="token comment">//                     cancelText=&quot;取消&quot;</span>
    <span class="token comment">//                     &gt;</span>
    <span class="token comment">//                     &lt;p className=&quot;text-center&quot;&gt;确认删除此信息吗,&lt;strong className=&quot;color-red&quot;&gt;删除后无法恢复&lt;/strong&gt;&lt;/p&gt;</span>
                        
    <span class="token comment">//                 &lt;/Modal&gt;</span>
    <span class="token comment">// //*********************************************************************************************</span>


    <span class="token comment">//             &lt;/Fragment&gt;</span>
    <span class="token comment">//         )</span>
    <span class="token comment">//     }</span>
    <span class="token comment">// }</span>

    <span class="token comment">// export default DepartmentList;</span>

</code></pre></div><ul><li>从列表跳至添加页面其实是编辑,添加及更改了一些方法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">//\src\views\department\Add.js</span>
    <span class="token comment">// //API</span>
    <span class="token comment">// import { DepartmentAdd,Detailed,Edit } from &quot;../../api/department&quot;;</span>

    <span class="token comment">// class AddDepartment extends Component{</span>
    <span class="token comment">//     constructor(props){</span>
    <span class="token comment">//         super();</span>
    <span class="token comment">//         this.state={</span>
    <span class="token comment">//             loading:false,</span>
    <span class="token comment">//             id:&quot;&quot;,</span>
    <span class="token comment">//             fromLayout:{</span>
    <span class="token comment">//                 labelCol:{span:2} ,</span>
    <span class="token comment">//                 wrapperCol:{span:20} </span>
    <span class="token comment">//             }</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//     }</span>

    <span class="token comment">//     //存储id避免Detailed传值写的过长</span>
    <span class="token comment">//     componentWillMount(){</span>
    <span class="token comment">//         if(this.props.location.state.id){</span>
    <span class="token comment">//             this.setState({</span>
    <span class="token comment">//                 id:this.props.location.state.id</span>
    <span class="token comment">//             })</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//     //接受List传过来的参数</span>
    <span class="token comment">//     componentDidMount(){</span>
    <span class="token comment">//         this.getDetailed()</span>
    <span class="token comment">//         // console.log(this.props.location.state.id);</span>
    <span class="token comment">//     }</span>

    <span class="token comment">//     getDetailed=()=&gt;{</span>
    <span class="token comment">//         if(!this.props.location.state){return false;}</span>
    <span class="token comment">//         Detailed({id:this.state.id}).then(response=&gt;{</span>
    <span class="token comment">//             console.log(response);</span>
    <span class="token comment">//             // const data = response.data.data</span>
    <span class="token comment">//             // this.refs.form.setFieldsValue({</span>
    <span class="token comment">//             //     content: data.content,</span>
    <span class="token comment">//             //     name: data.name,</span>
    <span class="token comment">//             //     number:data.number,</span>
    <span class="token comment">//             //     status: data.status</span>
    <span class="token comment">//             // })</span>
    <span class="token comment">//             this.refs.form.setFieldsValue(response.data.data)</span>
    <span class="token comment">//         })</span>
    <span class="token comment">//     }</span>

    <span class="token comment">//     onSubmit = (v) =&gt;{</span>
    <span class="token comment">//         if(!v.name){</span>
    <span class="token comment">//             message.error(&quot;部门不能为空&quot;);</span>
    <span class="token comment">//             return false;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         if(!v.number|| v.number ===0){</span>
    <span class="token comment">//             message.error(&quot;人员数量不能为0&quot;);</span>
    <span class="token comment">//             return false;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         if(!v.content){</span>
    <span class="token comment">//             message.error(&quot;描述不能为空&quot;);</span>
    <span class="token comment">//             return false;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         this.setState({</span>
    <span class="token comment">//             loading:true,</span>
    <span class="token comment">//         })</span>
    <span class="token comment">//     //确定按钮执行添加或者编辑</span>
    <span class="token comment">//     this.state.id?this.onHandlerAdd(v):this.onHandEdit(v)</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//     /**</span>
    <span class="token comment">//     * 添加信息</span>
    <span class="token comment">//     */</span>
    <span class="token comment">//     onHandlerAdd = (v)=&gt;{</span>
    <span class="token comment">//         DepartmentAdd(v).then(response=&gt;{</span>
    <span class="token comment">//             // console.log(response);</span>
    <span class="token comment">//             const data = response.data;</span>
    <span class="token comment">//             message.info(data.message);</span>
    <span class="token comment">//             this.setState({</span>
    <span class="token comment">//                 loading:false,</span>
    <span class="token comment">//             })</span>
    <span class="token comment">//             //重置表单</span>
    <span class="token comment">//             this.refs.form.resetFields();</span>
    <span class="token comment">//         }).catch(error=&gt;{</span>
    <span class="token comment">//             this.setState({</span>
    <span class="token comment">//                 loading:false,</span>
    <span class="token comment">//             })</span>
                
    <span class="token comment">//         })</span>
    <span class="token comment">//     }</span>

    <span class="token comment">//     /**</span>
    <span class="token comment">//     * 编辑信息</span>
    <span class="token comment">//     */</span>
    <span class="token comment">//     onHandEdit = (v) =&gt;{</span>
    <span class="token comment">//         const responseData = v</span>
    <span class="token comment">//         responseData.id = this.state.id </span>
    <span class="token comment">//         Edit(responseData).then(response=&gt;{</span>

    <span class="token comment">//         }).catch(error=&gt;{</span>
    <span class="token comment">//             this.setState({</span>
    <span class="token comment">//                 loading:false</span>
    <span class="token comment">//             })</span>
    <span class="token comment">//         })</span>
    <span class="token comment">//     } </span>

</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021-01-06 08:49:18</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/My-notes/front/react/project_04.html" class="prev">
        react首页
      </a></span> <span class="next"><a href="/My-notes/front/react/project_06.html">
        优化分离组件
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/My-notes/assets/js/app.015e7f34.js" defer></script><script src="/My-notes/assets/js/2.a0b16310.js" defer></script><script src="/My-notes/assets/js/34.4fa64215.js" defer></script><script src="/My-notes/assets/js/3.d5588be5.js" defer></script>
  </body>
</html>
